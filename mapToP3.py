import numpy as np

def F(q0,q1,q2,r0,r1,r2):
    q3=r3=1
    M = [[2*q0-q1, -q0+2*q1, 2*q2],
    [6*q0-10*q1-5*q3, -10*q0+8*q1+6*q3, 2*q2],
    [2*r0-r1, -r0+2*r1, 2*r2],
    [6*r0-10*r1-5*r3, -10*r0+8*r1+6*r3, 2*r2]]
    D1 = np.linalg.det(np.array(M[1:]))
    D2 = np.linalg.det(np.array([M[0]]+M[2:]))
    M = [[2*q0-q1, -q0+2*q1, 2*q2, -2*q3],
    [6*q0-10*q1-5*q3, -10*q0+8*q1+6*q3, 2*q2, -5*q0+6*q1+4*q3],
    [2*r0-r1, -r0+2*r1, 2*r2, -2*r3],
    [6*r0-10*r1-5*r3, -10*r0+8*r1+6*r3, 2*r2, -5*r0+6*r1+4*r3]]
    A = M[0][0]*D1 - M[1][0]*D2
    B = M[0][1]*D1 - M[1][1]*D2
    C = M[0][2]*D1 - M[1][2]*D2
    D = M[0][3]*D1 - M[1][3]*D2
    return (A/D, B/D, C/D)
