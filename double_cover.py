from __future__ import division

# map from {(x,t_i-x)}\subset P^3xP^3 to (P^3)^*
def F(q0,q1,q2,q3,r0,r1,r2,r3):
    A0 = 112*q0*q2*r0**2-252*q1*q2*r0**2-140*q2*q3*r0**2-32*q0*q2*r0*r1+72*q1*q2*r0*r1+40*q2*q3*r0*r1-96*q0*q2*r1**2+216*q1*q2*r1**2+120*q2*q3*r1**2-112*q0**2*r0*r2+32*q0*q1*r0*r2+96*q1**2*r0*r2+56*q0*q3*r0*r2+      32*q1*q3*r0*r2+252*q0**2*r1*r2-72*q0*q1*r1*r2-216*q1**2*r1*r2-126*q0*q3*r1*r2-72*q1*q3*r1*r2-56*q0*q2*r0*r3+126*q1*q2*r0*r3+70*q2*q3*r0*r3-32*q0*q2*r1*r3+72*q1*q2*r1*r3+40*q2*q3*r1*r3+140*q0**2*r2      *r3-40*q0*q1*r2*r3-120*q1**2*r2*r3-70*q0*q3*r2*r3-40*q1*q3*r2*r3
    A1 = -252*q0*q2*r0**2+168*q1*q2*r0**2+168*q2*q3*r0**2+72*q0*q2*r0*r1-48*q1*q2*r0*r1-48*q2*q3*r0*r1+216*q0*q2*r1**2-144*q1*q2*r1**2-144*q2*q3*r1**2+252*q0**2*r0*r2-72*q0*q1*r0*r2-216*q1**2*r0*r2-126*q0*q3*r0      *r2-72*q1*q3*r0*r2-168*q0**2*r1*r2+48*q0*q1*r1*r2+144*q1**2*r1*r2+84*q0*q3*r1*r2+48*q1*q3*r1*r2+126*q0*q2*r0*r3-84*q1*q2*r0*r3-84*q2*q3*r0*r3+72*q0*q2*r1*r3-48*q1*q2*r1*r3-48*q2*q3*r1*r3-168*q0**2      *r2*r3+48*q0*q1*r2*r3+144*q1**2*r2*r3+84*q0*q3*r2*r3+48*q1*q3*r2*r3
    A2 = -228*q1*q2*r0*r2-84*q2*q3*r0*r2+228*q0*q2*r1*r2-96*q2*q3*r1*r2+84*q0*q2*r2*r3+96*q1*q2*r2*r3
    A3 = -140*q0*q2*r0**2+168*q1*q2*r0**2+168*q2*q3*r0**2+40*q0*q2*r0*r1-48*q1*q2*r0*r1-48*q2*q3*r0*r1+120*q0*q2*r1**2-144*q1*q2*r1**2-144*q2*q3*r1**2+140*q0**2*r0*r2-178*q0*q1*r0*r2+12*q1**2*r0*r2-168*q0*q3*r0      *r2+240*q1*q3*r0*r2+84*q3**2*r0*r2-30*q0**2*r1*r2-84*q0*q1*r1*r2+144*q1**2*r1*r2-192*q0*q3*r1*r2+144*q1*q3*r1*r2+96*q3**2*r1*r2+70*q0*q2*r0*r3-84*q1*q2*r0*r3-84*q2*q3*r0*r3+40*q0*q2*r1*r3-48*q1*q2*      r1*r3-48*q2*q3*r1*r3-70*q0**2*r2*r3+44*q0*q1*r2*r3+48*q1**2*r2*r3-48*q1*q3*r2*r3
    return (A0,A1,A2,A3)

def images(q0,q1,q2,q3):
    # return the images in P^2 of (q,t_i-q) for each i
    R = [(q0,q1,-q2,q3),
         (-(2/7)*q0-(6/7)*q1+(2/7)*q3, -(9/8)*q0+(1/4)*q1+(1/4)*q3, q2, -(9/56)*q0-(3/28)*q1+(29/28)*q3),
         ((20/13)*q0-(6/13)*q1-(14/13)*q3, -(35/104)*q0+(67/52)*q1+(35/52)*q3, q2, (147/104)*q0-(63/52)*q1-(95/52)*q3),
         (-(23/91)*q0+(120/91)*q1+(72/91)*q3, (19/13)*q0-(7/13)*q1-(12/13)*q3, q2, -(114/91)*q0+(120/91)*q1+(163/91)*q3)]
    L = []
    for r0,r1,r2,r3 in R:
        t0,t1,t2,t3 = F(q0,q1,q2,q3,r0,r1,r2,r3)
        L.append((t1/t3,t2/t3) if abs(t3)>.01 else (t1,t2,t3))
    return L
